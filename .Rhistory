apply(star.dat[,2:dim(star.dat)[2]],2,sum)
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
sort(words)
help(sort)
sort(words, decreasing = TRUE)
star.dat$stars_x
sort(words, decreasing = TRUE)
room
star.dat$room
c(star.dat$stars_x, star.dat$room)
cbind(star.dat$stars_x, star.dat$room)
apply(star.dat$stars_x,2,count)
star1 <-length(which(star.dat$stars_x == 1))
star2 <-length(which(star.dat$stars_x == 2))
star3 <-length(which(star.dat$stars_x == 3))
star4 <-length(which(star.dat$stars_x == 4))
star5 <-length(which(star.dat$stars_x == 5))
star1
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
total.star1
sort(words, decreasing = TRUE)
length(which(star.dat$stars_x == 1 & star.dat$room == 1))
length(which(star.dat$stars_x == 1 & star.dat$room >= 1))
length(which(star.dat$stars_x == 2 & star.dat$room >= 1))
length(which(star.dat$stars_x == 3 & star.dat$room >= 1))
length(which(star.dat$stars_x == 4 & star.dat$room >= 1))
length(which(star.dat$stars_x == 5 & star.dat$room >= 1))
length(which(star.dat$stars_x == 1 & star.dat$room >= 1))
length(which(star.dat$stars_x == 1 && star.dat$room >= 1))
eval.star1 <- length(which(star.dat$stars_x == 1 & star.dat$word >= 1))
eval.star2 <- length(which(star.dat$stars_x == 2 & star.dat$word >= 1))
eval.star3 <- length(which(star.dat$stars_x == 3 & star.dat$word >= 1))
eval.star4 <-length(which(star.dat$stars_x == 4 & star.dat$word >= 1))
eval.star5 <-length(which(star.dat$stars_x == 5 & star.dat$word >= 1))
word.frequency <- function(word){
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
eval.star1 <- length(which(star.dat$stars_x == 1 & star.dat$word >= 1))
eval.star2 <- length(which(star.dat$stars_x == 2 & star.dat$word >= 1))
eval.star3 <- length(which(star.dat$stars_x == 3 & star.dat$word >= 1))
eval.star4 <-length(which(star.dat$stars_x == 4 & star.dat$word >= 1))
eval.star5 <-length(which(star.dat$stars_x == 5 & star.dat$word >= 1))
freq.star1 <- eval.star1/total.star1
freq.star2 <- eval.star2/total.star2
freq.star3 <- eval.star3/total.star3
freq.star4 <- eval.star4/total.star4
freq.star5 <- eval.star5/total.star5
c(freq.star1,freq.star2,freq.star3,freq.star4,freq.star5)
}
word.frequency("room")
word.frequency(room)
sort(words, decreasing = TRUE)
word.frequency(hotel)
word.frequency(room)
word.frequency(hotel)
word.frequency(room)
word.frequency(hotel)
star.dat$word
word.frequency <- function(a){
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
eval.star1 <- length(which(star.dat$stars_x == 1 & star.dat$a >= 1))
eval.star2 <- length(which(star.dat$stars_x == 2 & star.dat$a >= 1))
eval.star3 <- length(which(star.dat$stars_x == 3 & star.dat$a >= 1))
eval.star4 <-length(which(star.dat$stars_x == 4 & star.dat$a >= 1))
eval.star5 <-length(which(star.dat$stars_x == 5 & star.dat$a >= 1))
freq.star1 <- eval.star1/total.star1
freq.star2 <- eval.star2/total.star2
freq.star3 <- eval.star3/total.star3
freq.star4 <- eval.star4/total.star4
freq.star5 <- eval.star5/total.star5
c(freq.star1,freq.star2,freq.star3,freq.star4,freq.star5)
}
word.frequency(room)
word.frequency("room")
word.frequency(argument1 = "room")
word.frequency(argument1 = room)
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
freq.dat <- cbind(star.dat$stars_x,star.dat$room)
apply(freq.dat, 2, sum)
tapply(freq.dat, 2, sum)
word.frequency <- function(argument1){
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(star.dat$stars_x,star.dat$room)
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
word.frequency(argument1 = room)
word.frequency(hotel)
ind <- room
ind <- "room"
dat$ind
ind
dat[,ind]
ind <- "hotel"
dat[,ind]
word.frequency <- function(argument1){
ind <- argument1
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(star.dat$stars_x,star.dat[,ind])
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
word.frequency(room)
word.frequency("room")
sort(words, decreasing= TRUE)
dat <- read.csv("Data/df.csv",header=TRUE)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
sort(words, decreasing= TRUE)
word.frequency("great")
word.frequency("room")
plot(word.frequency("room"))
barplot(word.frequency("room"))
sort(words, decreasing= TRUE)
barplot(word.frequency("time"))
sort(words, decreasing= TRUE)
barplot(word.frequency("room"))
dat <- read.csv("Data/df_tip.csv",header=TRUE)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
sort(words, decreasing= TRUE)
word.frequency <- function(argument1){
ind <- argument1
total.star1 <-length(which(star.dat$stars_x == 1))
total.star2 <-length(which(star.dat$stars_x == 2))
total.star3 <-length(which(star.dat$stars_x == 3))
total.star4 <-length(which(star.dat$stars_x == 4))
total.star5 <-length(which(star.dat$stars_x == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(star.dat$stars_x,star.dat[,ind])
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
barplot(word.frequency("room"))
barplot(word.frequency("time"))
dat2 <- read.csv("Data/df_tip.csv",header=TRUE)
View(dat2)
dat2 <- read.csv("Data/df_tip.csv",header=TRUE)
tip.dat <- dat2[,c(2,11:dim(dat)[2])]
tip.dat <- dat2[,c(2,11:dim(dat2)[2])]
tip.words <- apply(tip.dat[,2:dim(tip.dat)[2]],2,sum)
sort(tip.words)
sort(tip.words, decreasing= TRUE)
word.tip.frequency <- function(argument1){
ind <- argument1
total.star1 <-length(which(tip.dat$stars == 1))
total.star2 <-length(which(tip.dat$stars == 2))
total.star3 <-length(which(tip.dat$stars == 3))
total.star4 <-length(which(tip.dat$stars == 4))
total.star5 <-length(which(tip.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(tip.dat$stars,tip.dat[,ind])
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
sort(tip.words, decreasing= TRUE)
word.tip.frequency("room")
View(star.dat)
View(tip.dat)
View(dat)
View(tip.dat)
word.tip.frequency <- function(argument1){
ind <- argument1
total.star1 <-length(which(tip.dat$stars == 1))
total.star1.5 <-length(which(tip.dat$stars == 1.5))
total.star2 <-length(which(tip.dat$stars == 2))
total.star2.5 <-length(which(tip.dat$stars == 2.5))
total.star3 <-length(which(tip.dat$stars == 3))
total.star3.5 <-length(which(tip.dat$stars == 3.5))
total.star4 <-length(which(tip.dat$stars == 4))
total.star4.5 <-length(which(tip.dat$stars == 4.5))
total.star5 <-length(which(tip.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(tip.dat$stars,tip.dat[,ind])
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
total.v <- c(total.star1,total.star1.5, total.star2, total.star2.5, total.star3, total.star3.5, total.star4,total.star4.5, total.star5)
word.tip.frequency <- function(argument1){
ind <- argument1
total.star1 <-length(which(tip.dat$stars == 1))
total.star1.5 <-length(which(tip.dat$stars == 1.5))
total.star2 <-length(which(tip.dat$stars == 2))
total.star2.5 <-length(which(tip.dat$stars == 2.5))
total.star3 <-length(which(tip.dat$stars == 3))
total.star3.5 <-length(which(tip.dat$stars == 3.5))
total.star4 <-length(which(tip.dat$stars == 4))
total.star4.5 <-length(which(tip.dat$stars == 4.5))
total.star5 <-length(which(tip.dat$stars == 5))
total.v <- c(total.star1,total.star1.5, total.star2, total.star2.5, total.star3, total.star3.5, total.star4,total.star4.5, total.star5)
freq.dat <- cbind(tip.dat$stars,tip.dat[,ind])
v <- tapply(freq.dat[,2], freq.dat[,1], sum)
v/total.v
}
word.tip.frequency("room")
sort(words, decreasing= TRUE)
