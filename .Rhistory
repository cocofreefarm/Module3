}
print(paste(hotel.names[1],"got",length(which(wordembedding.dat$name==hotel.names[1])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[1])]), xlab="Stars",ylab="Number of Review", main=hotel.names[1])
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[1]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[1],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
print(sort(part.words, decreasing= TRUE)[1:30])
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
words <- apply(star.dat[,3:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[1]))>10){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service <- c("booked","money","staff","manager","breakfast","desk")
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(ac.star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
words <- apply(star.dat[,3:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[30]))>10){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service <- c("booked","money","staff","manager","breakfast","desk")
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(ac.star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
part.dat["booked","money","staff","manager","breakfast","desk"
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
part.dat["booked","money","staff","manager","breakfast","desk"]
part.dat[,"booked","money","staff","manager","breakfast","desk"]
View(part.dat)
words
sort(words)
sort(words,decreasing = TRUE)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
sort(words,decreasing = TRUE)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
wordembedding.dat
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
sort(words,decreasing = TRUE)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
View(wordembedding.dat)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
sort(words,decreasing = TRUE)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(star.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
wordembedding.dat
View(wordembedding.dat)
sort(words[words>summary(words)[5]]
sort(words[words>summary(words)[5]])
sort(words[words>summary(words)[5]])
sort(words[words>summary(words)[5]], decreasing= TRUE)
which(part.dat["booked","money","staff","manager","breakfast","desk"]==1
part.dat[,"booked","money","staff","manager","breakfast","desk"]
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
which(part.dat["booked","money","staff","manager","breakfast","desk"]==1)
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
sort(words[words>summary(words)[5]], decreasing= TRUE)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[30]))>10){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service <- c("booked","money","staff","manager","breakfast","desk")
which(part.dat["booked","money","staff","manager","breakfast","desk"]==1)
part.dat[,"booked","money","staff","manager","breakfast","desk"]
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
View(wordembedding.dat)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
sort(words[words>summary(words)[5]], decreasing= TRUE)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[30]))>5){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service <- c("booked","money","staff","manager","breakfast","desk")
which(part.dat["booked","money","staff","manager","breakfast","desk"]==1)
part.dat[,"booked","money","staff","manager","breakfast","desk"]
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
which(part.dat["booked","money","staff","manager","breakfast","desk"]==1)
which(part.dat[,"booked","money","staff","manager","breakfast","desk"]==1)
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
sort(words[words>summary(words)[5]], decreasing= TRUE)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
hotel.names <- names(avg.hotel)
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[30]))>5){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service <- c("booked","money","staff","manager","breakfast","desk")
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
part.dat[,"booked","money","staff","manager","breakfast","desk"]
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
part.dat[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1),1]
part.dat[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1),]
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
part.dat[,c("booked","money","staff","manager","breakfast","desk")]
part.dat
View(part.dat)
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
View(part.dat)
part.dat[1,]
part.dat[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1),]
View(part.dat)
part.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
View(dat)
View(part.dat)
View(dat)
View(part.dat)
part.dat$stars[1]
View(part.dat)
View(part.dat)
part.dat[,c("booked","money","staff","manager","breakfast","desk")]
part.dat[,c("booked","money","staff","manager","breakfast","desk")]
which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)
part.dat <- as.data.frame(wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),])
View(part.dat)
wordembedding.dat[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1),]
wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]
mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","reataurant","location")]==1)]))
atmosphere.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")]==1)]))
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
sort(words[words>summary(words)[5]], decreasing= TRUE)
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","reataurant","location")]==1)]))
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","restaurant","location")]==1)]))
atmosphere.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")]==1)]))
print(service.avg)
print(facility.avg)
print(location.avg)
print(atmosphere.avg)
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","restaurant","location")]==1)]))
atmosphere.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")]==1)]))
print(paste(hotel.names[30],"obtained",service.avg,"star rate for service"))
print(paste(hotel.names[30],"obtained",facility.avg,"star rate for facility"))
print(paste(hotel.names[30],"obtained",location.avg,"star rate for location"))
print(paste(hotel.names[30],"obtained",atmosphere.avg,"star rate for atmosphere"))
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","restaurant","location")]==1)]))
atmosphere.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")]==1)]))
print(paste(hotel.names[30],"obtained",round(service.avg,1),"star rate for service"))
print(paste(hotel.names[30],"obtained",round(facility.avg,1),"star rate for facility"))
print(paste(hotel.names[30],"obtained",round(location.avg,1),"star rate for location"))
print(paste(hotel.names[30],"obtained",round(atmosphere.avg,1),"star rate for atmosphere"))
runApp('shinyhotel')
runApp('shinyhotel')
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
avg.hotel["Budget Host Aloha Inn Motel"]
runApp('shinyhotel')
setwd("C:/Users/hkang/Desktop/Module3")
runApp()
runApp('shinyhotel')
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
if (avg.hotel[input$Hotel_name]<mean(avg.hotel)){
print(paste(input$Hotel_name,"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(input$Hotel_name,"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(input$Hotel_name,"got",length(which(wordembedding.dat$name==input$Hotel_name)),"reviews from the customers"))
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
wordembedding.dat <- star.dat[,-c(1,2)]
for (i in 1:dim(wordembedding.dat)[2]){
wordembedding.dat[which(wordembedding.dat[,i] >=1),i]=1
}
words <- apply(wordembedding.dat[,1:dim(wordembedding.dat)[2]],2,sum)
stars <- star.dat[,1]
name <- star.dat[,2]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,name,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(as.numeric(wordembedding.dat$stars),wordembedding.dat$name,mean))
if (avg.hotel[1]<mean(avg.hotel)){
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is below the average rate of hotels in Madison Area"))
}else{
print(paste(hotel.names[30],"obtained",mean(avg.hotel),"average rate which is above the average rate of hotels in Madison Area"))
}
print(paste(hotel.names[30],"got",length(which(wordembedding.dat$name==hotel.names[30])),"reviews from the customers"))
barplot(table(wordembedding.dat$stars[which(wordembedding.dat$name==hotel.names[30])]), xlab="Stars",ylab="Number of Review", main=hotel.names[30])
if(length(which(wordembedding.dat$name==hotel.names[30]))>5){
part.dat <- wordembedding.dat[which(wordembedding.dat$name==hotel.names[30]),]
part.words <- apply(part.dat[,3:dim(part.dat)[2]],2,sum)
part.freq <- names(sort(part.words, decreasing= TRUE)[1:30])
print(paste("Most frequently appeared 30 words in reviews for",hotel.names[30],"are"))
print(sort(part.words, decreasing= TRUE)[1:30])
box.evaluation <- function(argument1){
ind <- argument1
index <- which(part.dat[ind]==1)
part.star <- as.numeric(part.dat[index,1])
mean(part.star)
index2 <- which(betterhotel.dat[ind]==1)
word.star <- as.numeric(wordembedding.dat[index2,1])
mean(word.star)
}
service.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("booked","money","staff","manager","breakfast","desk")]==1)]))
facility.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("wall","parking")]==1)]))
location.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("bar","downtown","restaurant","location")]==1)]))
atmosphere.avg <- mean(as.numeric(wordembedding.dat$stars[which(part.dat[,c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")]==1)]))
print(paste(hotel.names[30],"obtained",round(service.avg,1),"star rate for service"))
print(paste(hotel.names[30],"obtained",round(facility.avg,1),"star rate for facility"))
print(paste(hotel.names[30],"obtained",round(location.avg,1),"star rate for location"))
print(paste(hotel.names[30],"obtained",round(atmosphere.avg,1),"star rate for atmosphere"))
service <- c("booked","money","staff","manager","breakfast","desk")
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
boxplot(cbind(star,better.star),main=paste(ind,'.star comparison between high rated hotel and low rated hotel'))
t.test(ac.star,better.star)
}else{
print("Not enough reviews from customers")
}
runApp('shinyhotel')
getwd()
setwd()
dat <- read.csv("Data/df.csv",header=TRUE)
runApp()
runApp('shinyhotel')
runApp('shinyhotel')
getwd()
setwd()
dat <- read.csv("Data/df.csv",header=TRUE)
getwd()
setwd()
setwd(getwd())
dat <- read.csv("Data/df.csv",header=TRUE)
runApp('shinyhotel')
setwd("C:/Users/hkang/Desktop/Module3/Data")
dat <- read.csv("df.csv",header=TRUE)
dat <- read.csv("df.csv",header=TRUE)
runApp('C:/Users/hkang/Desktop/Module3/shinyhotel')
getwd()
runApp('C:/Users/hkang/Desktop/Module3/shinyhotel')
getwd()
setwd("C:/Users/hkang/Desktop/Module3")
getwd()
runApp('shinyhotel')
runApp('shinyhotel')
getwd()
as.numeric(wordembedding.dat$stars[which(part.dat[,"booked"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"booked"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"money"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"staff"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"manager"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"breakfast"]==1)])
as.numeric(wordembedding.dat$stars[which(part.dat[,"desk"]==1)])
service <- c("booked","money","staff","manager","breakfast","desk")
facility <- c("wall","parking")
location <- c("bar","downtown","reataurant","location")
atmosphere <- c("clean","comfortable","spacious","quiet","smell","modern","pretty","comfy","dirty")
book.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"booked"]==1)])
money.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"money"]==1)])
staff.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"staff"]==1)])
manager.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"manager"]==1)])
breakfast.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"breakfast"]==1)])
desk.part.star <- as.numeric(wordembedding.dat$stars[which(part.dat[,"desk"]==1)])
book.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"booked"]==1)])
money.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"money"]==1)])
staff.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"staff"]==1)])
manager.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"manager"]==1)])
breakfast.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"breakfast"]==1)])
desk.wordembedding.star <- as.numeric(wordembedding.dat$stars[which(wordembedding.dat[,"desk"]==1)])
