booked <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,2]==1){
if (test.dat[i,]$stars==1){
booked[i] = 1
}
else if(test.dat[i,]$stars==2){
booked[i] = 2
}
else if(test.dat[i,]$stars==3){
booked[i] = 3
}
else if(test.dat[i,]$stars==4){
booked[i] = 4
}
else {
booked[i] = 5
}
}
else{
booked[i] = 3
}
}
money <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,3]==1){
if (test.dat[i,]$stars==1){
money[i] = 1
}
else if(test.dat[i,]$stars==2){
money[i] = 2
}
else if(test.dat[i,]$stars==3){
money[i] = 3
}
else if(test.dat[i,]$stars==4){
money[i] = 4
}
else {
money[i] = 5
}
}
else{
money[i] = 3
}
}
staff <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,4]==1){
if (test.dat[i,]$stars==1){
staff[i] = 1
}
else if(test.dat[i,]$stars==2){
staff[i] = 2
}
else if(test.dat[i,]$stars==3){
staff[i] = 3
}
else if(test.dat[i,]$stars==4){
staff[i] = 4
}
else {
staff[i] = 5
}
}
else{
staff[i] = 3
}
}
manager <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,5]==1){
if (test.dat[i,]$stars==1){
manager[i] = 1
}
else if(test.dat[i,]$stars==2){
manager[i] = 2
}
else if(test.dat[i,]$stars==3){
manager[i] = 3
}
else if(test.dat[i,]$stars==4){
manager[i] = 4
}
else {
manager[i] = 5
}
}
else{
manager[i] = 3
}
}
breakfast <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,6]==1){
if (test.dat[i,]$stars==1){
breakfast[i] = 1
}
else if(test.dat[i,]$stars==2){
breakfast[i] = 2
}
else if(test.dat[i,]$stars==3){
breakfast[i] = 3
}
else if(test.dat[i,]$stars==4){
breakfast[i] = 4
}
else {
breakfast[i] = 5
}
}
else{
breakfast[i] = 3
}
}
desk <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,7]==1){
if (test.dat[i,]$stars==1){
desk[i] = 1
}
else if(test.dat[i,]$stars==2){
desk[i] = 2
}
else if(test.dat[i,]$stars==3){
desk[i] = 3
}
else if(test.dat[i,]$stars==4){
desk[i] = 4
}
else {
desk[i] = 5
}
}
else{
desk[i] = 3
}
}
wall <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,8]==1){
if (test.dat[i,]$stars==1){
wall[i] = 1
}
else if(test.dat[i,]$stars==2){
wall[i] = 2
}
else if(test.dat[i,]$stars==3){
wall[i] = 3
}
else if(test.dat[i,]$stars==4){
wall[i] = 4
}
else {
wall[i] = 5
}
}
else{
wall[i] = 3
}
}
toilet <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,9]==1){
if (test.dat[i,]$stars==1){
toilet[i] = 1
}
else if(test.dat[i,]$stars==2){
toilet[i] = 2
}
else if(test.dat[i,]$stars==3){
toilet[i] = 3
}
else if(test.dat[i,]$stars==4){
toilet[i] = 4
}
else {
toilet[i] = 5
}
}
else{
toilet[i] = 3
}
}
parking <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,10]==1){
if (test.dat[i,]$stars==1){
parking[i] = 1
}
else if(test.dat[i,]$stars==2){
parking[i] = 2
}
else if(test.dat[i,]$stars==3){
parking[i] = 3
}
else if(test.dat[i,]$stars==4){
parking[i] = 4
}
else {
parking[i] = 5
}
}
else{
parking[i] = 3
}
}
bar <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,11]==1){
if (test.dat[i,]$stars==1){
bar[i] = 1
}
else if(test.dat[i,]$stars==2){
bar[i] = 2
}
else if(test.dat[i,]$stars==3){
bar[i] = 3
}
else if(test.dat[i,]$stars==4){
bar[i] = 4
}
else {
bar[i] = 5
}
}
else{
bar[i] = 3
}
}
downtown <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,12]==1){
if (test.dat[i,]$stars==1){
downtown[i] = 1
}
else if(test.dat[i,]$stars==2){
downtown[i] = 2
}
else if(test.dat[i,]$stars==3){
downtown[i] = 3
}
else if(test.dat[i,]$stars==4){
downtown[i] = 4
}
else {
downtown[i] = 5
}
}
else{
downtown[i] = 3
}
}
restaurant <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,13]==1){
if (test.dat[i,]$stars==1){
restaurant[i] = 1
}
else if(test.dat[i,]$stars==2){
restaurant[i] = 2
}
else if(test.dat[i,]$stars==3){
restaurant[i] = 3
}
else if(test.dat[i,]$stars==4){
restaurant[i] = 4
}
else {
restaurant[i] = 5
}
}
else{
restaurant[i] = 3
}
}
location <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,14]==1){
if (test.dat[i,]$stars==1){
location[i] = 1
}
else if(test.dat[i,]$stars==2){
location[i] = 2
}
else if(test.dat[i,]$stars==3){
location[i] = 3
}
else if(test.dat[i,]$stars==4){
location[i] = 4
}
else {
location[i] = 5
}
}
else{
location[i] = 3
}
}
clean <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,15]==1){
if (test.dat[i,]$stars==1){
clean[i] = 1
}
else if(test.dat[i,]$stars==2){
clean[i] = 2
}
else if(test.dat[i,]$stars==3){
clean[i] = 3
}
else if(test.dat[i,]$stars==4){
clean[i] = 4
}
else {
clean[i] = 5
}
}
else{
clean[i] = 3
}
}
comfortable <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,16]==1){
if (test.dat[i,]$stars==1){
comfortable[i] = 1
}
else if(test.dat[i,]$stars==2){
comfortable[i] = 2
}
else if(test.dat[i,]$stars==3){
comfortable[i] = 3
}
else if(test.dat[i,]$stars==4){
comfortable[i] = 4
}
else {
comfortable[i] = 5
}
}
else{
comfortable[i] = 3
}
}
spacious <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,17]==1){
if (test.dat[i,]$stars==1){
spacious[i] = 1
}
else if(test.dat[i,]$stars==2){
spacious[i] = 2
}
else if(test.dat[i,]$stars==3){
spacious[i] = 3
}
else if(test.dat[i,]$stars==4){
spacious[i] = 4
}
else {
spacious[i] = 5
}
}
else{
spacious[i] = 3
}
}
quiet <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,18]==1){
if (test.dat[i,]$stars==1){
quiet[i] = 1
}
else if(test.dat[i,]$stars==2){
quiet[i] = 2
}
else if(test.dat[i,]$stars==3){
quiet[i] = 3
}
else if(test.dat[i,]$stars==4){
quiet[i] = 4
}
else {
quiet[i] = 5
}
}
else{
quiet[i] = 3
}
}
smell <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,19]==1){
if (test.dat[i,]$stars==1){
smell[i] = 1
}
else if(test.dat[i,]$stars==2){
smell[i] = 2
}
else if(test.dat[i,]$stars==3){
smell[i] = 3
}
else if(test.dat[i,]$stars==4){
smell[i] = 4
}
else {
smell[i] = 5
}
}
else{
smell[i] = 3
}
}
modern <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,20]==1){
if (test.dat[i,]$stars==1){
modern[i] = 1
}
else if(test.dat[i,]$stars==2){
modern[i] = 2
}
else if(test.dat[i,]$stars==3){
modern[i] = 3
}
else if(test.dat[i,]$stars==4){
modern[i] = 4
}
else {
modern[i] = 5
}
}
else{
modern[i] = 3
}
}
pretty <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,21]==1){
if (test.dat[i,]$stars==1){
pretty[i] = 1
}
else if(test.dat[i,]$stars==2){
pretty[i] = 2
}
else if(test.dat[i,]$stars==3){
pretty[i] = 3
}
else if(test.dat[i,]$stars==4){
pretty[i] = 4
}
else {
pretty[i] = 5
}
}
else{
pretty[i] = 3
}
}
comfy <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,22]==1){
if (test.dat[i,]$stars==1){
comfy[i] = 1
}
else if(test.dat[i,]$stars==2){
comfy[i] = 2
}
else if(test.dat[i,]$stars==3){
comfy[i] = 3
}
else if(test.dat[i,]$stars==4){
comfy[i] = 4
}
else {
comfy[i] = 5
}
}
else{
comfy[i] = 3
}
}
dirty <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,23]==1){
if (test.dat[i,]$stars==1){
dirty[i] = 1
}
else if(test.dat[i,]$stars==2){
dirty[i] = 2
}
else if(test.dat[i,]$stars==3){
dirty[i] = 3
}
else if(test.dat[i,]$stars==4){
dirty[i] = 4
}
else {
dirty[i] = 5
}
}
else{
dirty[i] = 3
}
}
stars <- as.factor(test.dat$stars)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
eval.m <- multinom(stars~.,data=eval.dat)
summary(eval.m)
table(predict(eval.m,eval.dat),stars)
sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
