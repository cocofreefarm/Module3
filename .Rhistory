}
else if(test.dat[i,]$stars==2){
breakfast[i] = 2
}
else if(test.dat[i,]$stars==3){
breakfast[i] = 3
}
else if(test.dat[i,]$stars==4){
breakfast[i] = 4
}
else {
breakfast[i] = 5
}
}
else{
breakfast[i] = 0
}
}
desk <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,5]==1){
if (test.dat[i,]$stars==1){
desk[i] = 1
}
else if(test.dat[i,]$stars==2){
desk[i] = 2
}
else if(test.dat[i,]$stars==3){
desk[i] = 3
}
else if(test.dat[i,]$stars==4){
desk[i] = 4
}
else {
desk[i] = 5
}
}
else{
desk[i] = 0
}
}
parking <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,6]==1){
if (test.dat[i,]$stars==1){
parking[i] = 1
}
else if(test.dat[i,]$stars==2){
parking[i] = 2
}
else if(test.dat[i,]$stars==3){
parking[i] = 3
}
else if(test.dat[i,]$stars==4){
parking[i] = 4
}
else {
parking[i] = 5
}
}
else{
parking[i] = 0
}
}
wall <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,7]==1){
if (test.dat[i,]$stars==1){
wall[i] = 1
}
else if(test.dat[i,]$stars==2){
wall[i] = 2
}
else if(test.dat[i,]$stars==3){
wall[i] = 3
}
else if(test.dat[i,]$stars==4){
wall[i] = 4
}
else {
wall[i] = 5
}
}
else{
wall[i] = 0
}
}
location <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,8]==1){
if (test.dat[i,]$stars==1){
location[i] = 1
}
else if(test.dat[i,]$stars==2){
location[i] = 2
}
else if(test.dat[i,]$stars==3){
location[i] = 3
}
else if(test.dat[i,]$stars==4){
location[i] = 4
}
else {
location[i] = 5
}
}
else{
location[i] = 0
}
}
bar <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,9]==1){
if (test.dat[i,]$stars==1){
bar[i] = 1
}
else if(test.dat[i,]$stars==2){
bar[i] = 2
}
else if(test.dat[i,]$stars==3){
bar[i] = 3
}
else if(test.dat[i,]$stars==4){
bar[i] = 4
}
else {
bar[i] = 5
}
}
else{
bar[i] = 0
}
}
clean <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,10]==1){
if (test.dat[i,]$stars==1){
clean[i] = 1
}
else if(test.dat[i,]$stars==2){
clean[i] = 2
}
else if(test.dat[i,]$stars==3){
clean[i] = 3
}
else if(test.dat[i,]$stars==4){
clean[i] = 4
}
else {
clean[i] = 5
}
}
else{
clean[i] = 0
}
}
comfortable <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,11]==1){
if (test.dat[i,]$stars==1){
comfortable[i] = 1
}
else if(test.dat[i,]$stars==2){
comfortable[i] = 2
}
else if(test.dat[i,]$stars==3){
comfortable[i] = 3
}
else if(test.dat[i,]$stars==4){
comfortable[i] = 4
}
else {
comfortable[i] = 5
}
}
else{
comfortable[i] = 0
}
}
spacious <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,12]==1){
if (test.dat[i,]$stars==1){
spacious[i] = 1
}
else if(test.dat[i,]$stars==2){
spacious[i] = 2
}
else if(test.dat[i,]$stars==3){
spacious[i] = 3
}
else if(test.dat[i,]$stars==4){
spacious[i] = 4
}
else {
spacious[i] = 5
}
}
else{
spacious[i] = 0
}
}
smell <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,13]==1){
if (test.dat[i,]$stars==1){
smell[i] = 1
}
else if(test.dat[i,]$stars==2){
smell[i] = 2
}
else if(test.dat[i,]$stars==3){
smell[i] = 3
}
else if(test.dat[i,]$stars==4){
smell[i] = 4
}
else {
smell[i] = 5
}
}
else{
smell[i] = 0
}
}
stars <- as.factor(test.dat$stars)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
eval.m <- multinom(stars~.,data=eval.dat)
require(nnet)
test.dat <- wordembedding.dat[c("stars","staff", "manager", "breakfast", "desk","parking","wall","location","bar","clean","comfortable","spacious","smell")]
staff <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,2]==1){
if (test.dat[i,]$stars==1){
staff[i] = 1
}
else if(test.dat[i,]$stars==2){
staff[i] = 2
}
else if(test.dat[i,]$stars==3){
staff[i] = 3
}
else if(test.dat[i,]$stars==4){
staff[i] = 4
}
else {
staff[i] = 5
}
}
else{
staff[i] = 0
}
}
manager <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,3]==1){
if (test.dat[i,]$stars==1){
manager[i] = 1
}
else if(test.dat[i,]$stars==2){
manager[i] = 2
}
else if(test.dat[i,]$stars==3){
manager[i] = 3
}
else if(test.dat[i,]$stars==4){
manager[i] = 4
}
else {
manager[i] = 5
}
}
else{
manager[i] = 0
}
}
breakfast <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,4]==1){
if (test.dat[i,]$stars==1){
breakfast[i] = 1
}
else if(test.dat[i,]$stars==2){
breakfast[i] = 2
}
else if(test.dat[i,]$stars==3){
breakfast[i] = 3
}
else if(test.dat[i,]$stars==4){
breakfast[i] = 4
}
else {
breakfast[i] = 5
}
}
else{
breakfast[i] = 0
}
}
desk <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,5]==1){
if (test.dat[i,]$stars==1){
desk[i] = 1
}
else if(test.dat[i,]$stars==2){
desk[i] = 2
}
else if(test.dat[i,]$stars==3){
desk[i] = 3
}
else if(test.dat[i,]$stars==4){
desk[i] = 4
}
else {
desk[i] = 5
}
}
else{
desk[i] = 0
}
}
parking <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,6]==1){
if (test.dat[i,]$stars==1){
parking[i] = 1
}
else if(test.dat[i,]$stars==2){
parking[i] = 2
}
else if(test.dat[i,]$stars==3){
parking[i] = 3
}
else if(test.dat[i,]$stars==4){
parking[i] = 4
}
else {
parking[i] = 5
}
}
else{
parking[i] = 0
}
}
wall <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,7]==1){
if (test.dat[i,]$stars==1){
wall[i] = 1
}
else if(test.dat[i,]$stars==2){
wall[i] = 2
}
else if(test.dat[i,]$stars==3){
wall[i] = 3
}
else if(test.dat[i,]$stars==4){
wall[i] = 4
}
else {
wall[i] = 5
}
}
else{
wall[i] = 0
}
}
location <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,8]==1){
if (test.dat[i,]$stars==1){
location[i] = 1
}
else if(test.dat[i,]$stars==2){
location[i] = 2
}
else if(test.dat[i,]$stars==3){
location[i] = 3
}
else if(test.dat[i,]$stars==4){
location[i] = 4
}
else {
location[i] = 5
}
}
else{
location[i] = 0
}
}
bar <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,9]==1){
if (test.dat[i,]$stars==1){
bar[i] = 1
}
else if(test.dat[i,]$stars==2){
bar[i] = 2
}
else if(test.dat[i,]$stars==3){
bar[i] = 3
}
else if(test.dat[i,]$stars==4){
bar[i] = 4
}
else {
bar[i] = 5
}
}
else{
bar[i] = 0
}
}
clean <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,10]==1){
if (test.dat[i,]$stars==1){
clean[i] = 1
}
else if(test.dat[i,]$stars==2){
clean[i] = 2
}
else if(test.dat[i,]$stars==3){
clean[i] = 3
}
else if(test.dat[i,]$stars==4){
clean[i] = 4
}
else {
clean[i] = 5
}
}
else{
clean[i] = 0
}
}
comfortable <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,11]==1){
if (test.dat[i,]$stars==1){
comfortable[i] = 1
}
else if(test.dat[i,]$stars==2){
comfortable[i] = 2
}
else if(test.dat[i,]$stars==3){
comfortable[i] = 3
}
else if(test.dat[i,]$stars==4){
comfortable[i] = 4
}
else {
comfortable[i] = 5
}
}
else{
comfortable[i] = 0
}
}
spacious <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,12]==1){
if (test.dat[i,]$stars==1){
spacious[i] = 1
}
else if(test.dat[i,]$stars==2){
spacious[i] = 2
}
else if(test.dat[i,]$stars==3){
spacious[i] = 3
}
else if(test.dat[i,]$stars==4){
spacious[i] = 4
}
else {
spacious[i] = 5
}
}
else{
spacious[i] = 0
}
}
smell <- c()
for(i in 1:dim(test.dat)[1]){
if (test.dat[i,13]==1){
if (test.dat[i,]$stars==1){
smell[i] = 1
}
else if(test.dat[i,]$stars==2){
smell[i] = 2
}
else if(test.dat[i,]$stars==3){
smell[i] = 3
}
else if(test.dat[i,]$stars==4){
smell[i] = 4
}
else {
smell[i] = 5
}
}
else{
smell[i] = 0
}
}
stars <- as.factor(test.dat$stars)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
eval.m <- multinom(stars~.,data=eval.dat)
summary(eval.m)
table(predict(eval.m,eval.dat),stars)
sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
