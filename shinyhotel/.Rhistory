}
cbind(test.dat$stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell)
stars <- test.dat$stars
eval.dat <- cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
View(eval.dat)
View(eval.dat)
lm(stars~.data=eval.dat)
lm(stars~.,data=eval.dat)
anova(lm(stars~.,data=eval.dat))
eval.m <- lm(stars~.,data=eval.dat)
summary(eval.m)
summary(eval.m)
anova(lm(stars~.,data=eval.dat))
summary(eval.m)
anova(lm(stars~.,data=eval.dat))
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat
for (i in 1:dim(star.dat)[2]-1){
wordembedding.dat[which(star.dat[,i+1] >=1),i+1]=1
}
stars <- star.dat[,1]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
View(wordembedding.dat)
View(star.dat)
View(test.dat)
stars <- as.factor(test.dat$stars)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
eval.m <- lm(stars~.,data=eval.dat)
eval.m <- multinom(stars~.,data=eval.dat)
require(nnet)
stars <- as.factor(test.dat$stars)
eval.dat <- as.data.frame(cbind(stars,staff,manager,breakfast,desk,parking,wall,location,bar,clean,comfortable,spacious,smell))
eval.m <- multinom(stars~.,data=eval.dat)
summary(eval.m)
anova(lm(stars~.,data=eval.dat))
summary(eval.m)
predict(eval.m,eval.dat)
cbind(predict(eval.m,eval.dat),stars)
table(cbind(predict(eval.m,eval.dat),stars))
table(predict(eval.m,eval.dat),stars)
1-sum(diag(table(test.pred, test.dat$Class)))/sum(table(test.pred, test.dat$Class))
table(predict(eval.m,eval.dat),stars)
1-sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
table(predict(eval.m,eval.dat),stars)
sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
1-sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
1-sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
sum(diag(table(predict(eval.m,eval.dat),stars)))/sum(table(predict(eval.m,eval.dat),stars))
q()
require(nnet)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat
for (i in 1:dim(star.dat)[2]-1){
wordembedding.dat[which(star.dat[,i+1] >=1),i+1]=1
}
stars <- star.dat[,1]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(wordembedding.dat$stars == 1))
total.star2 <-length(which(wordembedding.dat$stars == 2))
total.star3 <-length(which(wordembedding.dat$stars == 3))
total.star4 <-length(which(wordembedding.dat$stars == 4))
total.star5 <-length(which(wordembedding.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(wordembedding.dat$stars, wordembedding.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
freq.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(wordembedding.dat)[2]-1){
freq.vec <- freq(colnames(wordembedding.dat)[i+1])
freq.mat <- cbind(freq.mat,freq.vec)
}
stars <- levels(as.factor(star.dat$stars_x))
freq.data <- freq.mat[,-(1:2)]
colnames(freq.data) <- names(wordembedding.dat)[-1]
freq.data <- as.data.frame(cbind(stars,freq.data))
require(nnet)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
require(nnet)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat
for (i in 1:dim(star.dat)[2]-1){
wordembedding.dat[which(star.dat[,i+1] >=1),i+1]=1
}
stars <- star.dat[,1]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
avg.hotel <- sort(tapply(dat$stars_x,dat$name,mean))
avg.hotel
summary(avg.hotel)
freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(wordembedding.dat$stars == 1))
total.star2 <-length(which(wordembedding.dat$stars == 2))
total.star3 <-length(which(wordembedding.dat$stars == 3))
total.star4 <-length(which(wordembedding.dat$stars == 4))
total.star5 <-length(which(wordembedding.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(wordembedding.dat$stars, wordembedding.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
freq.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(wordembedding.dat)[2]-1){
freq.vec <- freq(colnames(wordembedding.dat)[i+1])
freq.mat <- cbind(freq.mat,freq.vec)
}
stars <- levels(as.factor(star.dat$stars_x))
freq.data <- freq.mat[,-(1:2)]
colnames(freq.data) <- names(wordembedding.dat)[-1]
freq.data <- as.data.frame(cbind(stars,freq.data))
length(avg.hotel[which(avg.hotel< 3.5)])
par(cex.axis=1)
barplot(avg.hotel[avg.hotel < 3.5], main = "Average rate of the Hotels who received lower rate in Madison", ylim = c(0,5),las=2)
lowrate.Hotels <- names(avg.hotel[avg.hotel < 3.5])
lowrate.Hotels
rev <- c()
for(i in 1:22){
rev[i] <- length(dat$stars_x[which(dat$name==lowrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==lowrate.Hotels[i])
ref <- c(ref,temp)
}
lowerhotel.dat <- dat[ref,-c(1,3:10)]
stars <- lowerhotel.dat[,1]
lowerhotel.dat <- cbind(stars, lowerhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
length(avg.hotel[avg.hotel > 3.5])
par(cex.axis=1)
barplot(avg.hotel[avg.hotel > 3.5], main = "Average rate of the Hotels who received better rate in Madison", ylim = c(0,5),las=2)
highrate.Hotels <- names(avg.hotel[avg.hotel > 3.5])
highrate.Hotels
rev <- c()
for(i in 1:22){
rev[i] <- length(dat$stars_x[which(dat$name==lowrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==lowrate.Hotels[i])
ref <- c(ref,temp)
}
lowerhotel.dat <- dat[ref,-c(1,3:10)]
stars <- lowerhotel.dat[,1]
lowerhotel.dat <- cbind(stars, lowerhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
length(avg.hotel[avg.hotel > 3.5])
par(cex.axis=1)
barplot(avg.hotel[avg.hotel > 3.5], main = "Average rate of the Hotels who received better rate in Madison", ylim = c(0,5),las=2)
highrate.Hotels <- names(avg.hotel[avg.hotel > 3.5])
highrate.Hotels
rev <- c()
for(i in 1:23){
rev[i] <- length(dat$stars_x[which(dat$name==highrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==highrate.Hotels[i])
ref <- c(ref,temp)
}
betterhotel.dat <- dat[ref,-c(1,3:10)]
stars <- betterhotel.dat[,1]
betterhotel.dat <- cbind(stars, betterhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
lower.freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(lowerhotel.dat$stars == 1))
total.star2 <-length(which(lowerhotel.dat$stars == 2))
total.star3 <-length(which(lowerhotel.dat$stars == 3))
total.star4 <-length(which(lowerhotel.dat$stars == 4))
total.star5 <-length(which(lowerhotel.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
better.freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(betterhotel.dat$stars == 1))
total.star2 <-length(which(betterhotel.dat$stars == 2))
total.star3 <-length(which(betterhotel.dat$stars == 3))
total.star4 <-length(which(betterhotel.dat$stars == 4))
total.star5 <-length(which(betterhotel.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(betterhotel.dat$stars, betterhotel.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
freq.lower.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(lowerhotel.dat)[2]-2){
freq.lower.vec <- lower.freq(colnames(lowerhotel.dat)[i+2])
freq.lower.mat <- cbind(freq.lower.mat,freq.lower.vec)
}
freq.higher.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(betterhotel.dat)[2]-2){
freq.higher.vec <- better.freq(colnames(betterhotel.dat)[i+2])
freq.higher.mat <- cbind(freq.higher.mat,freq.higher.vec)
}
stars <- levels(as.factor(wordembedding.dat$stars))
freq.lower.mat <- freq.lower.mat[,-(1:2)]
freq.higher.mat <- freq.higher.mat[,-(1:2)]
colnames(freq.lower.mat) <- names(wordembedding.dat)[-1]
colnames(freq.higher.mat) <- names(wordembedding.dat)[-1]
grade <- rep("lower",5)
lower.freq.dat <- as.data.frame(cbind(grade,stars,freq.lower.mat))
grade <- rep("better",5)
better.freq.dat <- as.data.frame(cbind(grade,stars,freq.higher.mat))
frequency.dat <- rbind(lower.freq.dat,better.freq.dat)
frequency.dat <- type.convert(frequency.dat)
frequency.dat$stars <- as.factor(frequency.dat$stars)
total.star4 <-length(which(lowerhotel.dat$stars == 4))
freq.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,"staff"])
v <- star4
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
v <- star4
which(lowerhotel.dat$stars == 3)
lowerhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)]
rev <- c()
for(i in 1:22){
rev[i] <- length(dat$stars_x[which(dat$name==lowrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==lowrate.Hotels[i])
ref <- c(ref,temp)
}
lowerhotel.dat <- wordembedding.dat[ref,]
stars <- lowerhotel.dat[,1]
lowerhotel.dat <- cbind(stars, lowerhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
lowerhotel.dat$stars <- as.factor(lowerhotel.dat$stars)
for(i in 1:23){
rev[i] <- length(dat$stars_x[which(dat$name==highrate.Hotels[i])])
}
highrate.Hotels <- names(avg.hotel[avg.hotel > 3.5])
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,11:dim(dat)[2])]
words <- apply(star.dat[,2:dim(star.dat)[2]],2,sum)
wordembedding.dat <- star.dat
for (i in 1:dim(star.dat)[2]-1){
wordembedding.dat[which(star.dat[,i+1] >=1),i+1]=1
}
stars <- star.dat[,1]
wordembedding.dat <- wordembedding.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))]
wordembedding.dat <- cbind(stars,wordembedding.dat)
wordembedding.dat$stars <- as.factor(wordembedding.dat$stars)
freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(wordembedding.dat$stars == 1))
total.star2 <-length(which(wordembedding.dat$stars == 2))
total.star3 <-length(which(wordembedding.dat$stars == 3))
total.star4 <-length(which(wordembedding.dat$stars == 4))
total.star5 <-length(which(wordembedding.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(wordembedding.dat$stars, wordembedding.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
freq.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(wordembedding.dat)[2]-1){
freq.vec <- freq(colnames(wordembedding.dat)[i+1])
freq.mat <- cbind(freq.mat,freq.vec)
}
stars <- levels(as.factor(star.dat$stars_x))
freq.data <- freq.mat[,-(1:2)]
colnames(freq.data) <- names(wordembedding.dat)[-1]
freq.data <- as.data.frame(cbind(stars,freq.data))
avg.hotel <- sort(tapply(dat$stars_x,dat$name,mean))
avg.hotel
summary(avg.hotel)
length(avg.hotel[which(avg.hotel< 3.5)])
par(cex.axis=1)
barplot(avg.hotel[avg.hotel < 3.5], main = "Average rate of the Hotels who received lower rate in Madison", ylim = c(0,5),las=2)
lowrate.Hotels <- names(avg.hotel[avg.hotel < 3.5])
lowrate.Hotels
rev <- c()
for(i in 1:22){
rev[i] <- length(dat$stars_x[which(dat$name==lowrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==lowrate.Hotels[i])
ref <- c(ref,temp)
}
lowerhotel.dat <- wordembedding.dat[ref,]
stars <- lowerhotel.dat[,1]
lowerhotel.dat <- cbind(stars, lowerhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
lowerhotel.dat$stars <- as.factor(lowerhotel.dat$stars)
length(avg.hotel[avg.hotel > 3.5])
par(cex.axis=1)
barplot(avg.hotel[avg.hotel > 3.5], main = "Average rate of the Hotels who received better rate in Madison", ylim = c(0,5),las=2)
highrate.Hotels <- names(avg.hotel[avg.hotel > 3.5])
highrate.Hotels
rev <- c()
for(i in 1:23){
rev[i] <- length(dat$stars_x[which(dat$name==highrate.Hotels[i])])
}
sum(rev)
ref <- c()
for (i in 1:23){
temp <- which(dat$name==highrate.Hotels[i])
ref <- c(ref,temp)
}
betterhotel.dat <- wordembedding.dat[ref,]
stars <- betterhotel.dat[,1]
betterhotel.dat <- cbind(stars, betterhotel.dat[names(sort(words[words>summary(words)[5]], decreasing= TRUE))])
betterhotel.dat$stars <- as.factor(betterhotel.dat$stars)
lower.freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(lowerhotel.dat$stars == 1))
total.star2 <-length(which(lowerhotel.dat$stars == 2))
total.star3 <-length(which(lowerhotel.dat$stars == 3))
total.star4 <-length(which(lowerhotel.dat$stars == 4))
total.star5 <-length(which(lowerhotel.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
better.freq <- function(argument1){
ind <- argument1
total.star1 <-length(which(betterhotel.dat$stars == 1))
total.star2 <-length(which(betterhotel.dat$stars == 2))
total.star3 <-length(which(betterhotel.dat$stars == 3))
total.star4 <-length(which(betterhotel.dat$stars == 4))
total.star5 <-length(which(betterhotel.dat$stars == 5))
total.v <- c(total.star1,total.star2,total.star3,total.star4,total.star5)
freq.dat <- cbind(betterhotel.dat$stars, betterhotel.dat[,ind])
star1 <-length(which(freq.dat[,1] == 1 & freq.dat[,2] == 1))
star2 <-length(which(freq.dat[,1] == 2 & freq.dat[,2] == 1))
star3 <-length(which(freq.dat[,1] == 3 & freq.dat[,2] == 1))
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
star5 <-length(which(freq.dat[,1] == 5 & freq.dat[,2] == 1))
v <- c(star1, star2, star3, star4, star5)
freq <- v/total.v
freq
}
freq.lower.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(lowerhotel.dat)[2]-2){
freq.lower.vec <- lower.freq(colnames(lowerhotel.dat)[i+2])
freq.lower.mat <- cbind(freq.lower.mat,freq.lower.vec)
}
freq.higher.mat <- matrix(rep(NA,5),nrow=5)
for (i in 1:dim(betterhotel.dat)[2]-2){
freq.higher.vec <- better.freq(colnames(betterhotel.dat)[i+2])
freq.higher.mat <- cbind(freq.higher.mat,freq.higher.vec)
}
stars <- levels(as.factor(wordembedding.dat$stars))
freq.lower.mat <- freq.lower.mat[,-(1:2)]
freq.higher.mat <- freq.higher.mat[,-(1:2)]
colnames(freq.lower.mat) <- names(wordembedding.dat)[-1]
colnames(freq.higher.mat) <- names(wordembedding.dat)[-1]
grade <- rep("lower",5)
lower.freq.dat <- as.data.frame(cbind(grade,stars,freq.lower.mat))
grade <- rep("better",5)
better.freq.dat <- as.data.frame(cbind(grade,stars,freq.higher.mat))
frequency.dat <- rbind(lower.freq.dat,better.freq.dat)
frequency.dat <- type.convert(frequency.dat)
frequency.dat$stars <- as.factor(frequency.dat$stars)
lowerhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)]
freq.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,"staff"])
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
v <- star4
non <- total.v-v
lowerhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)]
freq.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,"staff"])
star4 <-length(which(freq.dat[,1] == 4 & freq.dat[,2] == 1))
t.test(lowerhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)],betterhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)])
t.test(lowerhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)],betterhotel.dat[,"staff"][which(lowerhotel.dat$stars == 3)])
z.test
test.proportion <- function(star,argument1){
ind <- argument1
total.lower.star1 <-length(which(lowerhotel.dat$stars == 1))
total.lower.star2 <-length(which(lowerhotel.dat$stars == 2))
total.lower.star3 <-length(which(lowerhotel.dat$stars == 3))
total.lower.star4 <-length(which(lowerhotel.dat$stars == 4))
total.lower.star5 <-length(which(lowerhotel.dat$stars == 5))
total.lower.v <- c(total.lower.star1,total.lower.star2,total.lower.star3,total.lower.star4,total.lower.star5)
freq.lower.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,ind])
lower.star1 <-length(which(freq.lower.dat[,1] == 1 & freq.lower.dat[,2] == 1))
lower.star2 <-length(which(freq.lower.dat[,1] == 2 & freq.lower.dat[,2] == 1))
lower.star3 <-length(which(freq.lower.dat[,1] == 3 & freq.lower.dat[,2] == 1))
lower.star4 <-length(which(freq.lower.dat[,1] == 4 & freq.lower.dat[,2] == 1))
lower.star5 <-length(which(freq.lower.dat[,1] == 5 & freq.lower.dat[,2] == 1))
lower.v <- c(lower.star1, lower.star2, lower.star3, lower.star4, star5)
lower.dat <- cbind(lower.v,total.lower.v)
total.better.star1 <-length(which(betterhotel.dat$stars == 1))
total.better.star2 <-length(which(betterhotel.dat$stars == 2))
total.better.star3 <-length(which(betterhotel.dat$stars == 3))
total.better.star4 <-length(which(betterhotel.dat$stars == 4))
total.better.star5 <-length(which(betterhotel.dat$stars == 5))
total.better.v <- c(total.better.star1,total.better.star2,total.better.star3,total.better.star4,total.better.star5)
freq.better.dat <- cbind(betterhotel.dat$stars, betterhotel.dat[,ind])
better.star1 <-length(which(freq.better.dat[,1] == 1 & freq.better.dat[,2] == 1))
better.star2 <-length(which(freq.better.dat[,1] == 2 & freq.better.dat[,2] == 1))
better.star3 <-length(which(freq.better.dat[,1] == 3 & freq.better.dat[,2] == 1))
better.star4 <-length(which(freq.better.dat[,1] == 4 & freq.better.dat[,2] == 1))
better.star5 <-length(which(freq.better.dat[,1] == 5 & freq.better.dat[,2] == 1))
better.v <- c(better.star1, better.star2, better.star3, better.star4, better.star5)
better.dat <- cbind(better.v,total.better.v)
prop.test(x=c(lower.dat[star,1],better.dat[star,1]),n=c(lower.dat[star,2],better.dat[star,2]))
}
test.proportion(1,"staff")
test.proportion <- function(star,argument1){
ind <- argument1
total.lower.star1 <-length(which(lowerhotel.dat$stars == 1))
total.lower.star2 <-length(which(lowerhotel.dat$stars == 2))
total.lower.star3 <-length(which(lowerhotel.dat$stars == 3))
total.lower.star4 <-length(which(lowerhotel.dat$stars == 4))
total.lower.star5 <-length(which(lowerhotel.dat$stars == 5))
total.lower.v <- c(total.lower.star1,total.lower.star2,total.lower.star3,total.lower.star4,total.lower.star5)
freq.lower.dat <- cbind(lowerhotel.dat$stars, lowerhotel.dat[,ind])
lower.star1 <-length(which(freq.lower.dat[,1] == 1 & freq.lower.dat[,2] == 1))
lower.star2 <-length(which(freq.lower.dat[,1] == 2 & freq.lower.dat[,2] == 1))
lower.star3 <-length(which(freq.lower.dat[,1] == 3 & freq.lower.dat[,2] == 1))
lower.star4 <-length(which(freq.lower.dat[,1] == 4 & freq.lower.dat[,2] == 1))
lower.star5 <-length(which(freq.lower.dat[,1] == 5 & freq.lower.dat[,2] == 1))
lower.v <- c(lower.star1, lower.star2, lower.star3, lower.star4, lower.star5)
lower.dat <- cbind(lower.v,total.lower.v)
total.better.star1 <-length(which(betterhotel.dat$stars == 1))
total.better.star2 <-length(which(betterhotel.dat$stars == 2))
total.better.star3 <-length(which(betterhotel.dat$stars == 3))
total.better.star4 <-length(which(betterhotel.dat$stars == 4))
total.better.star5 <-length(which(betterhotel.dat$stars == 5))
total.better.v <- c(total.better.star1,total.better.star2,total.better.star3,total.better.star4,total.better.star5)
freq.better.dat <- cbind(betterhotel.dat$stars, betterhotel.dat[,ind])
better.star1 <-length(which(freq.better.dat[,1] == 1 & freq.better.dat[,2] == 1))
better.star2 <-length(which(freq.better.dat[,1] == 2 & freq.better.dat[,2] == 1))
better.star3 <-length(which(freq.better.dat[,1] == 3 & freq.better.dat[,2] == 1))
better.star4 <-length(which(freq.better.dat[,1] == 4 & freq.better.dat[,2] == 1))
better.star5 <-length(which(freq.better.dat[,1] == 5 & freq.better.dat[,2] == 1))
better.v <- c(better.star1, better.star2, better.star3, better.star4, better.star5)
better.dat <- cbind(better.v,total.better.v)
prop.test(x=c(lower.dat[star,1],better.dat[star,1]),n=c(lower.dat[star,2],better.dat[star,2]))
}
test.proportion(1,"staff")
test.proportion(1:2,"staff")
test.proportion(1:3,"staff")
avg.hotel <- sort(tapply(dat$stars_x,dat$name,mean))
avg.hotel
colname <- avg.hotel
hotel.names <- names(avg.hotel)
avg.hotel <- sort(tapply(dat$stars_x,dat$name,mean))
hotel.names <- names(avg.hotel)
average
mean(avg.hotel)
star.dat$name.1
star.dat <- dat[,c(2,11:dim(dat)[2])]
View(star.dat)
View(dat)
dat <- read.csv("Data/df.csv",header=TRUE)
star.dat <- dat[,c(2,5,11:dim(dat)[2])]
dat <- read.csv("Data/df.csv",header=TRUE)
dat <- read.csv("Data/df.csv",header=TRUE)
setwd("C:/Users/hkang/Desktop/Module3/shinyhotel")
library(shiny)
library(ggplot2)
